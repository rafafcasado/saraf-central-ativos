<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Saraf</title>
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
    <script>
        WebFont.load({
            google: {
                "families": ["Poppins:300,400,500,600,700", "Roboto:300,400,500,600,700"]
            },
            active: function () {
                sessionStorage.fonts = true;
            }
        });
    </script>
    <link href="~/content/vendors/global/vendors.bundle.css" rel="stylesheet" type="text/css" />
    <link href="~/content/css/style.bundle.css" rel="stylesheet" type="text/css" />
    <link href="~/content/css/skins/header/base/light.css" rel="stylesheet" type="text/css" />
    <link href="~/content/css/skins/header/menu/light.css" rel="stylesheet" type="text/css" />
    <link href="~/content/css/skins/brand/light.css" rel="stylesheet" type="text/css" />
    <link href="~/content/css/skins/aside/light.css" rel="stylesheet" type="text/css" />
    <link href="https://unpkg.com/vue-simple-notify/dist/vue-simple-notify.min.css">
    <link rel="icon" type="image/png" href="~/content/img/ico.png" />
</head>
<body class="kt-quick-panel--right kt-demo-panel--right kt-offcanvas-panel--right kt-header--fixed kt-header-mobile--fixed kt-subheader--fixed kt-subheader--enabled kt-subheader--solid kt-aside--enabled kt-aside--fixed kt-aside--minimize kt-page--loading">
    <div id="content-default">
        <div class="kt-aside  kt-aside--fixed  kt-grid__item kt-grid kt-grid--desktop kt-grid--hor-desktop" id="kt_aside" style="opacity: 1;">
            <!-- begin:: Aside -->
            <div class="kt-aside__brand kt-grid__item " id="kt_aside_brand" kt-hidden-height="65" style="">
                <div class="kt-aside__brand-logo">
                    <a href="dashboard.html">
                        <img alt="Logo" src="~/content/img/logo.png" style="width: 70%;">
                    </a>
                </div>
            </div>
            <!-- end:: Aside -->
            <!-- begin:: Aside Menu -->
            <div class="kt-aside-menu-wrapper kt-grid__item kt-grid__item--fluid">
                <div id="kt_aside_menu" class="kt-aside-menu kt-scroll ps ps--active-y" data-ktmenu-vertical="1" data-ktmenu-scroll="1" data-ktmenu-dropdown-timeout="500" style="height: 228px; overflow: hidden;">
                    <ul class="kt-menu__nav ">
                        <li class="kt-menu__item kt-menu__item--submenu" aria-haspopup="true" data-ktmenu-submenu-toggle="hover" v-if="menusADM.length > 0">
                            <a href="javascript:;" class="kt-menu__link kt-menu__toggle">
                                <span class="kt-menu__link-icon">
                                    <i class="fas fa-cog fa-lg"></i>
                                </span><span class="kt-menu__link-text">Administrador</span><i class="kt-menu__ver-arrow la la-angle-right"></i>
                            </a>
                            <div class="kt-menu__submenu " kt-hidden-height="200" style="">
                                <span class="kt-menu__arrow"></span>
                                <ul class="kt-menu__subnav">
                                    <li class="kt-menu__item  kt-menu__item--parent" aria-haspopup="true">
                                        <span class="kt-menu__link"><span class="kt-menu__link-text">Administrador</span></span>
                                    </li>
                                    <li class="kt-menu__item kt-menu__item--submenu" aria-haspopup="false" data-ktmenu-submenu-toggle="hover" v-for="menu in menusADM">
                                        <a v-bind:href="menu.Menu.Url" class="kt-menu__link kt-menu__toggle">
                                            <span class="kt-menu__link-icon">
                                                <i v-bind:class="menu.Menu.Icone"></i>
                                            </span>
                                            <span class="kt-menu__link-text">{{menu.Menu.TituloMenu}}</span>
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </li>

                        <li class="kt-menu__item kt-menu__item--submenu" aria-haspopup="true" data-ktmenu-submenu-toggle="hover" v-if="exibeMenuEmpresa()">
                            <a href="javascript:;" class="kt-menu__link kt-menu__toggle">
                                <span class="kt-menu__link-icon">
                                    <i class="fas fa-building fa-lg"></i>
                                </span><span class="kt-menu__link-text">{{empresaNome}}</span><i class="kt-menu__ver-arrow la la-angle-right"></i>
                            </a>
                            <div class="kt-menu__submenu " kt-hidden-height="200" style="">
                                <span class="kt-menu__arrow"></span>
                                <ul class="kt-menu__subnav">
                                    <li class="kt-menu__item  kt-menu__item--parent" aria-haspopup="true">
                                        <span class="kt-menu__link"><span class="kt-menu__link-text">{{empresaNome}}</span></span>
                                    </li>
                                    <li class="kt-menu__item" aria-haspopup="true"><button type="button" class="btn btn-danger" v-on:click="sairEmpresa"></i>Sair da Empresa</button></li>
                                    <li v-for="menu in menusEmpresa" class="kt-menu__item" aria-haspopup="true"><a v-bind:href="menu.Menu.Url" class="kt-menu__link "><i class="kt-menu__link-bullet kt-menu__link-bullet--dot"><span></span></i><span class="kt-menu__link-text">{{menu.Menu.TituloMenu}}</span></a></li>

                                </ul>
                            </div>
                        </li>
                    </ul>
                    <div class="ps__rail-x" style="left: 0px; bottom: 0px;">
                        <div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div>
                    </div>
                    <div class="ps__rail-y" style="top: 0px; height: 228px; right: 3px;">
                        <div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 47px;"></div>
                    </div>
                </div>
            </div>
            <!-- end:: Aside Menu -->
        </div>
        <div id="kt_header_mobile" class="kt-header-mobile  kt-header-mobile--fixed ">
            <div class="kt-header-mobile__toolbar">
                <button class="kt-header-mobile__toggler kt-header-mobile__toggler--left" id="kt_aside_mobile_toggler"><span></span></button>
                <button class="kt-header-mobile__toggler" id="kt_header_mobile_toggler"><span></span></button>
                <button class="kt-header-mobile__topbar-toggler" id="kt_header_mobile_topbar_toggler"><i class="flaticon-more"></i></button>
            </div>
        </div>
        <div id="kt_header" class="kt-header kt-grid__item  kt-header--fixed ">
            <!-- begin:: Header Menu -->
            <button class="kt-header-menu-wrapper-close" id="kt_header_menu_mobile_close_btn"><i class="la la-close"></i></button>
            <div class="kt-header-menu-wrapper pl-4 pt-4" id="kt_header_menu_wrapper" style="opacity: 1;">
                Você está trabalhando como: <strong v-if="exibeMenuEmpresa()">{{empresaNome}}</strong><strong v-else>Administrador</strong><br />
                <small>Nesse cenário você tem acesso à informações gerais como Cadastro de Perfis, Usuários e Empresas</small>
                <div id="kt_header_menu" class="kt-header-menu kt-header-menu-mobile  kt-header-menu--layout-default mt-4"></div>
            </div>
            <div class="kt-header__topbar">

                <!--begin: My Cart -->
                <!--begin: User Bar -->
                <div class="kt-header__topbar-item kt-header__topbar-item--user">
                    <div class="kt-header__topbar-wrapper" data-toggle="dropdown" data-offset="0px,0px" aria-expanded="false">
                        <div class="kt-header__topbar-user">
                            <span class="kt-header__topbar-welcome kt-hidden-mobile">Olá,</span>
                            <span class="kt-header__topbar-username kt-hidden-mobile"><span class="nomeUsuario"></span></span>
                            @*<img class="kt-hidden" alt="Pic" src="./assets/media/users/300_25.jpg">*@

                            <!--use below badge element instead the user avatar to display username's first letter(remove kt-hidden class to display it) -->
                            <span class="kt-badge kt-badge--username kt-badge--unified-success kt-badge--lg kt-badge--rounded kt-badge--bold"></span>
                        </div>
                    </div>
                    <div class="dropdown-menu dropdown-menu-fit dropdown-menu-right dropdown-menu-anim dropdown-menu-top-unround dropdown-menu-xl" x-placement="bottom-end" style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(944px, 64px, 0px);">

                        <!--begin: Head -->
                        <div class="kt-user-card kt-user-card--skin-dark kt-notification-item-padding-x" style="background-color: lightblue;">
                            <div class="kt-user-card__avatar">
                                @*<img class="kt-hidden" alt="Pic" src="./assets/media/users/300_25.jpg">*@

                                <!--use below badge element instead the user avatar to display username's first letter(remove kt-hidden class to display it) -->
                                <span class="kt-badge kt-badge--lg kt-badge--rounded kt-badge--bold kt-font-success">S</span>
                            </div>
                            <div class="kt-user-card__name">
                                <span class="nomeUsuario"></span>
                            </div>
                        </div>

                        <!--end: Head -->
                        <!--begin: Navigation -->
                        <div class="kt-notification">
                            <a href="#" class="kt-notification__item">
                                <div class="kt-notification__item-icon">
                                    <i class="flaticon2-calendar-3 kt-font-success"></i>
                                </div>
                                <div class="kt-notification__item-details">
                                    <div class="kt-notification__item-title kt-font-bold">
                                        Minha conta
                                    </div>
                                    <div class="kt-notification__item-time">
                                        Edite sua conta
                                    </div>
                                </div>
                            </a>
                            <a href="#" class="kt-notification__item">
                                <div class="kt-notification__item-icon">
                                    <i class="flaticon2-mail kt-font-warning"></i>
                                </div>
                                <div class="kt-notification__item-details">
                                    <div class="kt-notification__item-title kt-font-bold">
                                        Minhas notificações
                                    </div>
                                    <div class="kt-notification__item-time">
                                        Inbox e tarefas
                                    </div>
                                </div>
                            </a>
                            <div class="kt-notification__custom kt-space-between">
                                <a href="~/home/login" class="btn btn-label btn-label-brand btn-sm btn-bold">Sair</a>
                            </div>
                        </div>

                        <!--end: Navigation -->
                    </div>
                </div>

                <!--end: User Bar -->
            </div>
        </div>
    </div>
    <div class="kt-grid__item kt-grid__item--fluid kt-grid kt-grid--hor kt-wrapper" id="kt_wrapper" style="padding: 60px !important;">
        <div class="kt-content  kt-grid__item kt-grid__item--fluid" id="kt_content" style="padding: 0px !important;">
            <div class="row justify-content-center">
                <div class="col-md-12">
                    <div class="kt-content kt-grid__item kt-grid__item--fluid" id="kt_content">
                        @RenderBody()
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" tabindex="-1" role="dialog" id="aguarde">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Aguarde</h5>
                </div>
                <div class="modal-body">

                    <p class="text-center">
                        <img src="~/Content/img/loading.gif" class="w-25" />
                    </p>
                    <hr />
                    <p class="text-center">Estamos processando sua requisição.</p>
                    <p class="text-center">Aguarde, por favor.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" tabindex="-1" role="dialog" id="mensagem">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <p class="text-center" id="conteudoMensagem"></p>
                    <hr />
                    <p class="text-center"><button type="button" class="btn btn-primary" data-dismiss="modal">OK</button></p>
                    
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="~/content/vendors/global/vendors.bundle.js" type="text/javascript"></script>
    <script src="~/content/js/scripts.bundle.js" type="text/javascript"></script>
    <environment include="Development">
        <script src="~/content/vendors/vue/vue.js" type="text/javascript"></script>
    </environment>
    <environment exclude="Development">
        <script src="~/content/vendors/vue/vue.min.js" type="text/javascript"></script>
    </environment>
    <script src="~/content/vendors/vue/vuelidate.min.js" type="text/javascript"></script>
    <script src="~/content/vendors/vue/validators.min.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/v-mask/dist/v-mask.min.js"></script>
    <script src="~/content/js/common.js" type="text/javascript" asp-append-version="true"></script>
    <script src="~/Content/js/select2.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.nomeUsuario').html(localStorage.userName);

            var iniciais = localStorage.userName.split(' ');
            var iniT = '';

            if (iniciais.length == 1)
                iniT = iniciais[0].substr(0, 1);
            else
                iniT = iniciais[0].substr(0, 1) + iniciais[iniciais.length - 1].substr(0, 1);

            $('.kt-badge').html(iniT);
        });

        new Vue({
            el: '#content-default',
            data() {
                return {
                    menusADM: [],
                    menusEmpresa: [],
                    usuarioLogado: {},
                    empresaNome: '',
                    errors: {}
                };
            },

            methods: {

                getUsuarioLogado() {

                    api.get('helpers/getUsuarioLogado', true)
                        .then(({ data, errors }) => {
                            this.errors = errors || {};
                            if (errors) {
                                return;
                            }

                            this.usuarioLogado = data;
                            this.listarMenus();
                        });
                },

                listarMenus() {

                    api.get('menu/getbyperfilid/' + this.usuarioLogado.PerfilID, true)
                        .then(({ data, errors }) => {
                            this.errors = errors || {};
                            if (errors) {
                                return;
                            }

                            for (var i = 0; i < data.length; i++) {

                                data[i].Menu.Icone = this.classeIcone(data[i]);
                                data[i].Menu.Url = config.baseURLWeb + data[i].Menu.Url;
                            }

                            this.menusADM = data.filter(x => { return x.Menu.TipoMenu == 1 });
                            this.menusEmpresa = data.filter(x => { return x.Menu.TipoMenu == 2 });
                            this.atualizarEmpresaNome();
                        });
                },

                classeIcone(menu) {

                    return 'fas ' + menu.Menu.Icone + ' fa-lg';
                },

                exibeMenuEmpresa() {

                    return this.menusEmpresa.length > 0 && localStorage.getItem('empresaID')
                },

                atualizarEmpresaNome() {

                    if (localStorage.getItem('empresaNome'))
                        this.empresaNome = localStorage.getItem('empresaNome');
                    else
                        this.empresaNome = '';
                },

                sairEmpresa() {

                    localStorage.removeItem('empresaID');
                    localStorage.removeItem('empresaNome');

                    window.location.href = '/';
                }
            },

            mounted() {

                this.getUsuarioLogado();
            }
        });
    </script>
    @RenderSection("Scripts", required: false)

</body>
</html>